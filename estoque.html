<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>InfoCar | Gestão de Estoque</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* MESMO CSS DARK/BLUE DO SEU SISTEMA */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #081862 0%, #00082a 100%);
      min-height: 100vh; padding: 20px; color: #e4edff;
    }
    .topo { 
      background: rgb(11, 11, 11); padding: 24px; border-radius: 15px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 24px; 
      display: flex; justify-content: space-between; align-items: center; 
    }
    .logo h1 { color: #2563eb; font-size: 2.2em; font-weight: 700; }
    .logo span { color: #c7cfdd; font-weight: 500; font-size: 1.1em; }
    .topo a { 
      color: #c7cfdd; text-decoration: none; font-weight: 600; padding: 10px 20px; 
      border: 2px solid #2a2a4a; border-radius: 10px; transition: all 0.3s;
    }
    .topo a:hover { color: #2563eb; border-color: #2563eb; background: rgba(37,99,235,0.1); }
    
    .container { max-width: 1400px; margin: 0 auto; }
    .card { 
      background: rgb(15, 15, 25); border: 1px solid #1a1a2e; 
      border-radius: 15px; padding: 32px; margin-bottom: 24px; 
      box-shadow: 0 15px 35px rgba(1, 39, 255, 0.3); 
    }
    h2 { 
      color: #e4edff; margin-bottom: 28px; border-bottom: 3px solid #2563eb; 
      padding-bottom: 12px; font-size: 1.8em; font-weight: 600;
    }
    
    /* FORM ENTRADA */
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
    label { 
      display: block; font-weight: 600; color: #a3bffa; margin: 20px 0 8px; 
      font-size: 0.95em;
    }
    input, select { 
      width: 100%; padding: 16px 20px; background: #1a1a2e; border: 2px solid #2a2a4a; 
      border-radius: 12px; color: #e4edff; font-size: 16px; transition: all 0.3s;
      font-family: inherit;
    }
    input:focus { 
      outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37,99,235,0.2);
      background: #222240;
    }
    input[type="number"] { -moz-appearance: textfield; }
    input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    input::placeholder { color: #64748b; }
    
    .botoes { display: flex; gap: 16px; margin-top: 32px; }
    button { 
      flex: 1; padding: 18px 32px; border: none; border-radius: 12px; font-weight: 600; 
      font-size: 16px; cursor: pointer; transition: all 0.3s; font-family: inherit;
    }
    #adicionarPeca { 
      background: linear-gradient(135deg, #10b981, #059669); color: white; 
    }
    #adicionarPeca:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(16,185,129,0.4); }
    button.sec { 
      background: #2a2a4a; color: #c7cfdd; border: 2px solid #3a3a5a;
    }
    button.sec:hover { background: #3a3a5a; border-color: #2563eb; }
    
    /* LISTA ESTOQUE */
    #buscaPeca { 
      width: 100%; padding: 16px 20px; background: #1a1a2e; border: 2px solid #2a2a4a; 
      border-radius: 12px; color: #e4edff; font-size: 16px; margin-bottom: 20px;
    }
    #buscaPeca:focus { border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37,99,235,0.2); }
    
    .stats-estoque { 
      display: flex; gap: 20px; margin-bottom: 24px; flex-wrap: wrap;
    }
    .stat-item { 
      background: rgba(37, 99, 235, 0.1); padding: 12px 20px; border-radius: 10px; 
      border: 1px solid #2a2a4a; font-weight: 600;
    }
    .stat-critico { background: rgba(245, 158, 11, 0.2); border-color: #f59e0b; color: #fbbf24; }
    
    #listaPecas { 
      max-height: 500px; overflow-y: auto; display: flex; flex-direction: column; gap: 16px;
    }
    .peca-item { 
      background: rgba(37, 99, 235, 0.08); border: 1px solid #2a2a4a; 
      border-left: 4px solid #2563eb; padding: 24px; border-radius: 12px; 
      cursor: pointer; transition: all 0.3s; display: flex; justify-content: space-between;
      align-items: center; flex-wrap: wrap; gap: 16px;
    }
    .peca-item:hover { 
      background: rgba(37, 99, 235, 0.15); transform: translateX(4px);
      box-shadow: 0 10px 30px rgba(37,99,235,0.2);
    }
    .peca-critica { border-left-color: #f59e0b !important; background: rgba(245, 158, 11, 0.1) !important; }
    .peca-critica:hover { background: rgba(245, 158, 11, 0.2) !important; }
    .peca-info { flex: 1; }
    .peca-codigo { font-weight: 700; font-size: 1.1em; color: #e4edff; margin-bottom: 4px; }
    .peca-nome { color: #c7cfdd; font-size: 0.95em; margin-bottom: 8px; }
    .peca-statuses { display: flex; gap: 12px; align-items: center; }
    .peca-qtd { 
      background: rgba(34, 197, 94, 0.2); color: #22c55e; padding: 6px 12px; 
      border-radius: 20px; font-weight: 600; font-size: 0.9em;
    }
    .peca-critica .peca-qtd { 
      background: rgba(245, 158, 11, 0.3); color: #f59e0b;
    }
    .peca-acao { 
      background: linear-gradient(135deg, #2563eb, #1d4ed8); color: white; 
      padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer;
      transition: all 0.3s;
    }
    .peca-acao:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(37,99,235,0.4); }
    
    .sem-dados { 
      text-align: center; padding: 80px 20px; color: #64748b; 
      font-style: italic; font-size: 1.1em;
    }
    
    @media (max-width: 768px) { 
      .form-grid { grid-template-columns: 1fr; }
      .botoes { flex-direction: column; }
      .peca-item { flex-direction: column; align-items: flex-start; text-align: left; }
      body { padding: 12px; }
    }
  </style>
</head>
<body>
  <header class="topo">
    <div class="logo">
      <h1>InfoCar </h1>
      <span>Gestão de Estoque Inteligente</span>
    </div>
    <a href="index.html">← Dashboard Executivo</a>
  </header>

  <main class="container">
    <!-- NOVA ENTRADA -->
    <section class="card">
      <h2>Nova Entrada de Peça</h2>
      <div class="form-grid">
        <div>
          <label for="codigoPeca">Código da Peça *</label>
          <input id="codigoPeca" placeholder="MH725/2" required>
        </div>
        <div>
          <label for="nomePeca">Nome/Descrição *</label>
          <input id="nomePeca" placeholder="Filtro de Óleo Motor" required>
        </div>
        <div>
          <label for="qtd">Quantidade Entrada</label>
          <input type="number" id="qtd" min="1" placeholder="10" required>
        </div>
        <div>
          <label for="preco">Preço Unitário (R$)</label>
          <input type="number" id="preco" step="0.01" min="0" placeholder="45.00" required>
        </div>
        <div>
          <label for="fornecedor">Fornecedor</label>
          <input id="fornecedor" placeholder="AutoPeças Premium Ltda">
        </div>
        <div>
          <label for="estoqueMin">Estoque Mínimo</label>
          <input type="number" id="estoqueMin" min="0" value="5">
        </div>
      </div>
      <div class="botoes">
        <button id="adicionarPeca">Adicionar ao Estoque</button>
        <button class="sec" id="limparPeca">Limpar Formulário</button>
      </div>
    </section>

    <!-- ESTOQUE ATUAL -->
    <section class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <h2>Controle de Estoque</h2>
        <div class="stats-estoque">
          <div class="stat-item" id="totalPecas">(0 itens)</div>
          <div class="stat-item stat-critico" id="criticas">0 críticos</div>
        </div>
      </div>
      <input type="text" id="buscaPeca" placeholder=" Buscar por código, nome ou fornecedor...">
      <div id="listaPecas">
        <div class="sem-dados">Cadastre as primeiras peças para visualizar o estoque</div>
      </div>
    </section>
  </main>

  <footer class="rodape">
    © 2026 InfoCar — Controle de Estoque + Alertas Automáticos Críticos
  </footer>

  <script>
    class EstoquePro {
      constructor() {
        this.DB_KEY = "infocar_estoque_v1";
        this.estoque = JSON.parse(localStorage.getItem(this.DB_KEY) || "[]");
        this.initEvents();
        this.renderEstoque();
      }

      initEvents() {
        $("#adicionarPeca").addEventListener("click", () => this.adicionar());
        $("#limparPeca").addEventListener("click", () => this.limpar());
        $("#buscaPeca").addEventListener("input", () => this.buscar());
      }

      adicionar() {
        const peca = {
          id: Date.now().toString(36) + Math.random().toString(36).slice(2),
          codigo: $("#codigoPeca").value.trim().toUpperCase(),
          nome: $("#nomePeca").value.trim(),
          qtd: parseInt($("#qtd").value) || 0,
          preco: parseFloat($("#preco").value) || 0,
          fornecedor: $("#fornecedor").value.trim(),
          estoqueMin: parseInt($("#estoqueMin").value) || 0,
          dataEntrada: new Date().toLocaleString("pt-BR")
        };

        if (!peca.codigo || !peca.nome || peca.qtd <= 0 || peca.preco <= 0) {
          alert("Preencha todos os campos obrigatórios!");
          return;
        }

        // Verifica se já existe
        const existe = this.estoque.find(p => p.codigo === peca.codigo);
        if (existe) {
          if (confirm(`Peça ${peca.codigo} já existe. Somar ${peca.qtd} unidades?`)) {
            existe.qtd += peca.qtd;
            existe.dataEntrada = peca.dataEntrada;
          } else return;
        } else {
          this.estoque.push(peca);
        }

        this.salvar();
        this.limpar();
        this.renderEstoque();
        this.toast(" Peça adicionada ao estoque!");
      }

      limpar() {
        $("#codigoPeca").value = "";
        $("#nomePeca").value = "";
        $("#qtd").value = "";
        $("#preco").value = "";
        $("#fornecedor").value = "";
        $("#estoqueMin").value = "5";
      }

      salvar() {
        localStorage.setItem(this.DB_KEY, JSON.stringify(this.estoque));
      }

      renderEstoque(filtradas = this.estoque) {
        const total = filtradas.length;
        const criticas = filtradas.filter(p => p.qtd <= p.estoqueMin).length;
        
        $("#totalPecas").textContent = `(${total} itens)`;
        $("#criticas").textContent = `${criticas} críticos`;

        $("#listaPecas").innerHTML = filtradas.map(peca => {
          const isCritica = peca.qtd <= peca.estoqueMin;
          return `
            <div class="peca-item ${isCritica ? 'peca-critica' : ''}">
              <div class="peca-info">
                <div class="peca-codigo">${peca.codigo}</div>
                <div class="peca-nome">${peca.nome}</div>
                <div style="color:#94a3b8;font-size:0.9em;">
                  ${peca.fornecedor} • ${peca.dataEntrada}
                </div>
              </div>
              <div class="peca-statuses">
                <div class="peca-qtd">Qtd: ${peca.qtd}</div>
                <div style="color:#94a3b8;font-size:0.85em;">Mín: ${peca.estoqueMin}</div>
                <div class="peca-acao" onclick="estoquePro.editar('${peca.id}')">Editar</div>
              </div>
            </div>
          `;
        }).join('') || '<div class="sem-dados">Nenhuma peça cadastrada no estoque</div>';
      }

      buscar() {
        const termo = $("#buscaPeca").value.toLowerCase();
        const filtradas = this.estoque.filter(peca => 
          peca.codigo.toLowerCase().includes(termo) ||
          peca.nome.toLowerCase().includes(termo) ||
          peca.fornecedor?.toLowerCase().includes(termo)
        );
        this.renderEstoque(filtradas);
      }

      editar(id) {
        alert(`Editar peça ID: ${id} (implemente modal de edição)`);
      }

      toast(msg) {
        const t = document.createElement('div');
        t.textContent = msg;
        t.className = 'toast';
        t.style.cssText = `
          position:fixed;top:24px;right:24px;background:linear-gradient(135deg,#10b981,#059669);
          color:white;padding:16px 24px;border-radius:12px;box-shadow:0 15px 35px rgba(16,185,129,0.4);
          font-weight:600;z-index:10000;transform:translateX(400px);transition:all 0.4s;
          backdrop-filter:blur(10px);
        `;
        document.body.appendChild(t);
        setTimeout(() => t.style.transform = 'translateX(0)', 100);
        setTimeout(() => t.remove(), 3500);
      }
    }

    const $ = s => document.querySelector(s);
    let estoquePro;
    window.addEventListener("DOMContentLoaded", () => {
      estoquePro = new EstoquePro();
    });
  </script>
</body>
</html>
